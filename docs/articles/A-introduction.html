<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="rsimsum">
<title>Introduction to rsimsum • rsimsum</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Atkinson_Hyperlegible-0.4.8/font.css" rel="stylesheet">
<link href="../deps/Ubuntu_Condensed-0.4.8/font.css" rel="stylesheet">
<!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to rsimsum">
<meta property="og:description" content="rsimsum">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">rsimsum</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.13.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/A-introduction.html">Introduction to rsimsum</a>
    <a class="dropdown-item" href="../articles/B-relhaz.html">Simulating a simulation study</a>
    <a class="dropdown-item" href="../articles/C-plotting.html">Visualising results from rsimsum</a>
    <a class="dropdown-item" href="../articles/D-nlp.html">Nested loop plots</a>
    <a class="dropdown-item" href="../articles/E-custom-inputs.html">Custom input values for confidence intervals and true values</a>
    <a class="dropdown-item" href="../articles/F-rsimsumtidyverse.html">rsimsum and the tidyverse</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ellessenne/rsimsum/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Introduction to rsimsum</h1>
                        <h4 data-toc-skip class="author">Alessandro
Gasparini</h4>
            
            <h4 data-toc-skip class="date">2024-02-29</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ellessenne/rsimsum/blob/HEAD/vignettes/A-introduction.Rmd" class="external-link"><code>vignettes/A-introduction.Rmd</code></a></small>
      <div class="d-none name"><code>A-introduction.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="rsimsum">rsimsum<a class="anchor" aria-label="anchor" href="#rsimsum"></a>
</h2>
<p><code>rsimsum</code> is an R package that can compute summary
statistics from simulation studies. It is inspired by the user-written
command <code>simsum</code> in Stata (White I.R., 2010).</p>
<p>The aim of <code>rsimsum</code> is helping reporting of simulation
studies, including understanding the role of chance in results of
simulation studies. Specifically, <code>rsimsum</code> can compute Monte
Carlo standard errors of summary statistics, defined as the standard
deviation of the estimated summary statistic; these are reported by
default.</p>
<p>Formula for summary statistics and Monte Carlo standard errors are
presented in the next section. Note that the terms <em>summary
statistic</em> and <em>performance measure</em> are used
interchangeably.</p>
</div>
<div class="section level2">
<h2 id="notation">Notation<a class="anchor" aria-label="anchor" href="#notation"></a>
</h2>
<p>We will use th following notation throughout this vignette:</p>
<ul>
<li>
<span class="math inline">\(\theta\)</span>: an estimand, and its
true value</li>
<li>
<span class="math inline">\(n_{\text{sim}}\)</span>: number of
simulations</li>
<li>
<span class="math inline">\(i = 1, \dots, n_{\text{sim}}\)</span>:
indexes a given simulation</li>
<li>
<span class="math inline">\(\hat{\theta}_i\)</span>: the estimated
value of <span class="math inline">\(\theta\)</span> for the <span class="math inline">\(i^{\text{th}}\)</span> replication</li>
<li>
<span class="math inline">\(\widehat{\text{Var}}(\hat{\theta}_i)\)</span>: the
estimated variance <span class="math inline">\(\text{Var}(\hat{\theta}_i)\)</span> of <span class="math inline">\(\hat{\theta}_i\)</span> for the <span class="math inline">\(i^{\text{th}}\)</span> replication</li>
<li>
<span class="math inline">\(\text{Var}(\hat{\theta})\)</span>: the
empirical variance of <span class="math inline">\(\hat{\theta}\)</span>
</li>
<li>
<span class="math inline">\(\alpha\)</span>: the nominal
significance level</li>
</ul>
</div>
<div class="section level2">
<h2 id="performance-measures">Performance measures<a class="anchor" aria-label="anchor" href="#performance-measures"></a>
</h2>
<p>The first performance measure of interest is <strong>bias</strong>,
which quantifies whether the estimator targets the true value <span class="math inline">\(\theta\)</span> on average. Bias is calculated
as:</p>
<p><span class="math display">\[\text{Bias} = \frac{1}{n_{\text{sim}}}
\sum_{i = 1} ^ {n_{\text{sim}}} \hat{\theta}_i - \theta\]</span></p>
<p>The Monte Carlo standard error of bias is calculated as:</p>
<p><span class="math display">\[\text{MCSE(Bias)} =
\sqrt{\frac{\frac{1}{n_{\text{sim}} - 1} \sum_{i = 1} ^ {n_{\text{sim}}}
(\hat{\theta}_i - \bar{\theta}) ^ 2}{n_{\text{sim}}}}\]</span></p>
<p><code>rsimsum</code> can also compute <strong>relative bias</strong>
(<em>relative</em> to the true value <span class="math inline">\(\theta\)</span>), which can be interpreted
similarly as with bias, but in relative terms rather than absolute. This
is calculated as:</p>
<p><span class="math display">\[\text{Relative Bias} =
\frac{1}{n_{\text{sim}}} \sum_{i = 1} ^ {n_{\text{sim}}}
\frac{\hat{\theta}_i - \theta}{\theta}\]</span></p>
<p>Its Monte Carlo standard error is calculated as:</p>
<p><span class="math display">\[
\text{MCSE(Relative Bias)} =  \sqrt{\frac{1}{n_{\text{sim}}
(n_{\text{sim}} - 1)} \sum_i^{n_{\text{sim} \left[ \frac{\hat{\theta}_i
- \theta}{\theta} - \widehat{\text{Relative Bias}} \right]^2}
\]</span></p>
<p>The <strong>empirical standard error</strong> of <span class="math inline">\(\theta\)</span> depends only on <span class="math inline">\(\hat{\theta}\)</span> and does not require any
knowledge of <span class="math inline">\(\theta\)</span>. It estimates
the standard deviation of <span class="math inline">\(\hat{\theta}\)</span> over the <span class="math inline">\(n_{\text{sim}}\)</span> replications:</p>
<p><span class="math display">\[\text{Empirical SE} =
\sqrt{\frac{1}{n_{\text{sim}} - 1} \sum_{i = 1} ^ {n_{\text{sim}}}
(\hat{\theta}_i - \bar{\theta}) ^ 2}\]</span></p>
<p>The Monte Carlo standard error is calculated as:</p>
<p><span class="math display">\[\text{MCSE(Emp. SE)} =
\frac{\widehat{\text{Emp. SE}}}{\sqrt{2 (n_{\text{sim}} -
1)}}\]</span></p>
<p>When comparing different methods, the <strong>relative precision of a
given method B against a reference method A</strong> is computed as:</p>
<p><span class="math display">\[\text{Relative % increase in precision}
= 100 \left[ \left( \frac{\widehat{\text{Emp.
SE}}_A}{\widehat{\text{Emp. SE}}_B} \right) ^ 2 - 1 \right]\]</span></p>
<p>Its (approximated) Monte Carlo standard error is:</p>
<p><span class="math display">\[\text{MCSE(Relative % increase in
precision)} \simeq 200 \left( \frac{\widehat{\text{Emp.
SE}}_A}{\widehat{\text{Emp. SE}}_B} \right)^2 \sqrt{\frac{1 -
\rho^2_{AB}}{n_{\text{sim}} - 1}}\]</span></p>
<p><span class="math inline">\(\rho^2_{AB}\)</span> is the correlation
of <span class="math inline">\(\hat{\theta}_A\)</span> and <span class="math inline">\(\hat{\theta}_B\)</span>.</p>
<p>A measure that takes into account both precision and accuracy of a
method is the <strong>mean squared error</strong>, which is the sum of
the squared bias and variance of <span class="math inline">\(\hat{\theta}\)</span>:</p>
<p><span class="math display">\[\text{MSE} = \frac{1}{n_{\text{sim}}}
\sum_{i = 1} ^ {n_{\text{sim}}} (\hat{\theta}_i - \theta) ^
2\]</span></p>
<p>The Monte Carlo standard error is:</p>
<p><span class="math display">\[\text{MCSE(MSE)} = \sqrt{\frac{\sum_{i =
1} ^ {n_{\text{sim}}} \left[ (\hat{\theta}_i - \theta) ^2 - \text{MSE}
\right] ^ 2}{n_{\text{sim}} (n_{\text{sim}} - 1)}}\]</span></p>
<p>The <strong>model based standard error</strong> is computed by
averaging the estimated standard errors for each replication:</p>
<p><span class="math display">\[\text{Model SE} =
\sqrt{\frac{1}{n_{\text{sim}}} \sum_{i = 1} ^ {n_{\text{sim}}}
\widehat{\text{Var}}(\hat{\theta}_i)}\]</span></p>
<p>Its (approximated) Monte Carlo standard error is computed as:</p>
<p><span class="math display">\[\text{MCSE(Model SE)} \simeq
\sqrt{\frac{\text{Var}[\widehat{\text{Var}}(\hat{\theta}_i)]}{4
n_{\text{sim}} \widehat{\text{Model SE}}}}\]</span></p>
<p>The model standard error targets the empirical standard error. Hence,
the <strong>relative error in the model standard error</strong> is an
informative performance measure:</p>
<p><span class="math display">\[\text{Relative % error in model SE} =
100 \left( \frac{\text{Model SE}}{\text{Empirical SE}} -
1\right)\]</span></p>
<p>Its Monte Carlo standard error is computed as:</p>
<p><span class="math display">\[\text{MCSE(Relative % error in model
SE)} = 100 \left( \frac{\text{Model SE}}{\text{Empirical SE}} \right)
\sqrt{\frac{\text{Var}[\widehat{\text{Var}}(\hat{\theta}_i)]}{4
n_{\text{sim}} \widehat{\text{Model SE}} ^ 4} +
\frac{1}{2(n_{\text{sim}} - 1)}}\]</span></p>
<p><strong>Coverage</strong> is another key property of an estimator. It
is defined as the probability that a confidence interval contains the
true value <span class="math inline">\(\theta\)</span>, and computed
as:</p>
<p><span class="math display">\[\text{Coverage} =
\frac{1}{n_{\text{sim}}} \sum_{i = 1} ^ {n_{\text{sim}}}
I(\hat{\theta}_{i, \text{low}} \le \theta \le \hat{\theta}_{i,
\text{upp}})\]</span></p>
<p>where <span class="math inline">\(I(\cdot)\)</span> is the indicator
function. The Monte Carlo standard error is computed as:</p>
<p><span class="math display">\[\text{MCSE(Coverage)} =
\sqrt{\frac{\text{Coverage} \times (1 -
\text{Coverage})}{n_{\text{sim}}}}\]</span></p>
<p>Under coverage is to be expected if:</p>
<ol style="list-style-type: decimal">
<li>
<span class="math inline">\(\text{Bias} \ne 0\)</span>, or</li>
<li>
<span class="math inline">\(\text{Models SE} &lt; \text{Empirical
SE}\)</span>, or</li>
<li>the distribution of <span class="math inline">\(\hat{\theta}\)</span> is not normal and intervals
have been constructed assuming normality, or</li>
<li>
<span class="math inline">\(\widehat{\text{Var}}(\hat{\theta}_i)\)</span> is
too variable</li>
</ol>
<p>Over coverage occurs as a result of <span class="math inline">\(\text{Models SE} &gt; \text{Empirical
SE}\)</span>.</p>
<p>As under coverage may be a result of bias, another useful summary
statistic is <strong>bias-eliminated coverage</strong>:</p>
<p><span class="math display">\[\text{Bias-eliminated coverage} =
\frac{1}{n_{\text{sim}}} \sum_{i = 1} ^ {n_{\text{sim}}}
I(\hat{\theta}_{i, \text{low}} \le \bar{\theta} \le \hat{\theta}_{i,
\text{upp}}) \]</span></p>
<p>The Monte Carlo standard error is analogously as coverage:</p>
<p><span class="math display">\[\text{MCSE(Bias-eliminated coverage)} =
\sqrt{\frac{\text{Bias-eliminated coverage} \times (1 -
\text{Bias-eliminated coverage})}{n_{\text{sim}}}}\]</span></p>
<p>Finally, <strong>power</strong> of a significance test at the <span class="math inline">\(\alpha\)</span> level is defined as:</p>
<p><span class="math display">\[\text{Power} = \frac{1}{n_{\text{sim}}}
\sum_{i = 1} ^ {n_{\text{sim}}} I \left[ |\hat{\theta}_i| \ge
z_{\alpha/2} \times \sqrt{\widehat{\text{Var}}(\hat{\theta_i})}
\right]\]</span></p>
<p>The Monte Carlo standard error is analogously as coverage:</p>
<p><span class="math display">\[\text{MCSE(Power)} =
\sqrt{\frac{\text{Power} \times (1 -
\text{Power})}{n_{\text{sim}}}}\]</span></p>
<p>Further information on summary statistics for simulation studies can
be found in White (2010) and Morris, White, and Crowther (2019).</p>
</div>
<div class="section level2">
<h2 id="example-1-simulation-study-on-missing-data">Example 1: Simulation study on missing data<a class="anchor" aria-label="anchor" href="#example-1-simulation-study-on-missing-data"></a>
</h2>
<p>With this example dataset included in <code>rsimsum</code> we aim to
summarise a simulation study comparing different ways to handle missing
covariates when fitting a Cox model (White and Royston, 2009). One
thousand datasets were simulated, each containing normally distributed
covariates <span class="math inline">\(x\)</span> and <span class="math inline">\(z\)</span> and time-to-event outcome. Both
covariates has <span class="math inline">\(20\%\)</span> of their values
deleted independently of all other variables so the data became missing
completely at random (Little and Rubin, 2002). Each simulated dataset
was analysed in three ways. A Cox model was fit to the complete cases
(<code>CC</code>). Then two methods of multiple imputation using chained
equations (van Buuren, Boshuizen, and Knook, 1999) were used. The
<code>MI_LOGT</code> method multiply imputes the missing values of <span class="math inline">\(x\)</span> and <span class="math inline">\(z\)</span> with the outcome included as <span class="math inline">\(\log(t)\)</span> and <span class="math inline">\(d\)</span>, where <span class="math inline">\(t\)</span> is the survival time and <span class="math inline">\(d\)</span> is the event indicator. The
<code>MI_T</code> method is the same except that <span class="math inline">\(\log(t)\)</span> is replaced by <span class="math inline">\(t\)</span> in the imputation model.</p>
<p>We load the data in the usual way:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ellessenne.github.io/rsimsum/">rsimsum</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"MIsim"</span>, package <span class="op">=</span> <span class="st">"rsimsum"</span><span class="op">)</span></span></code></pre></div>
<p>Let’s have a look at the first 10 rows of the dataset:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">MIsim</span>, n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 10 × 4</span></span></span>
<span><span class="co">#&gt;    dataset method      b    se</span></span>
<span><span class="co">#&gt;      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>       1 CC      0.707 0.147</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>       1 MI_T    0.684 0.126</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>       1 MI_LOGT 0.712 0.141</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>       2 CC      0.349 0.160</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>       2 MI_T    0.406 0.141</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>       2 MI_LOGT 0.429 0.136</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>       3 CC      0.650 0.152</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>       3 MI_T    0.503 0.130</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>       3 MI_LOGT 0.560 0.117</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>       4 CC      0.432 0.126</span></span></code></pre></div>
<p>The included variables are:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">MIsim</span><span class="op">)</span></span>
<span><span class="co">#&gt; tibble [3,000 × 4] (S3: tbl_df/tbl/data.frame)</span></span>
<span><span class="co">#&gt;  $ dataset: num [1:3000] 1 1 1 2 2 2 3 3 3 4 ...</span></span>
<span><span class="co">#&gt;  $ method : chr [1:3000] "CC" "MI_T" "MI_LOGT" "CC" ...</span></span>
<span><span class="co">#&gt;  $ b      : num [1:3000] 0.707 0.684 0.712 0.349 0.406 ...</span></span>
<span><span class="co">#&gt;  $ se     : num [1:3000] 0.147 0.126 0.141 0.16 0.141 ...</span></span>
<span><span class="co">#&gt;  - attr(*, "label")= chr "simsum example: data from a simulation study comparing 3 ways to handle missing"</span></span></code></pre></div>
<ul>
<li><p><code>dataset</code>, the number of the simulated
dataset;</p></li>
<li><p><code>method</code>, the method used (<code>CC</code>,
<code>MI_LOGT</code> or <code>MI_T</code>);</p></li>
<li><p><code>b</code>, the point estimate;</p></li>
<li><p><code>se</code>, the standard error of the point
estimate.</p></li>
</ul>
<p>We summarise the results of the simulation study by method using the
<code>simsum</code> function:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">s1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simsum.html">simsum</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">MIsim</span>, estvarname <span class="op">=</span> <span class="st">"b"</span>, true <span class="op">=</span> <span class="fl">0.50</span>, se <span class="op">=</span> <span class="st">"se"</span>, methodvar <span class="op">=</span> <span class="st">"method"</span>, ref <span class="op">=</span> <span class="st">"CC"</span><span class="op">)</span></span></code></pre></div>
<p>We set <code>true = 0.50</code> as the true value of the point
estimate <code>b</code> - under which the data was simulated - is 0.50.
We select <code>CC</code> as the reference method as we consider the
complete cases analysis the reference method to benchmark against; if we
do not set a reference method, <code>simsum</code> picks one
automatically.</p>
<p>Using the default settings, Monte Carlo standard errors are computed
and returned.</p>
<p>Summarising a <code>simsum</code> object, we obtain the following
output:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ss1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">s1</span><span class="op">)</span></span>
<span><span class="va">ss1</span></span>
<span><span class="co">#&gt; Values are:</span></span>
<span><span class="co">#&gt;  Point Estimate (Monte Carlo Standard Error)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Non-missing point estimates/standard errors:</span></span>
<span><span class="co">#&gt;    CC MI_LOGT MI_T</span></span>
<span><span class="co">#&gt;  1000    1000 1000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Average point estimate:</span></span>
<span><span class="co">#&gt;      CC MI_LOGT   MI_T</span></span>
<span><span class="co">#&gt;  0.5168  0.5009 0.4988</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Median point estimate:</span></span>
<span><span class="co">#&gt;      CC MI_LOGT   MI_T</span></span>
<span><span class="co">#&gt;  0.5070  0.4969 0.4939</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Average variance:</span></span>
<span><span class="co">#&gt;      CC MI_LOGT   MI_T</span></span>
<span><span class="co">#&gt;  0.0216  0.0182 0.0179</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Median variance:</span></span>
<span><span class="co">#&gt;      CC MI_LOGT   MI_T</span></span>
<span><span class="co">#&gt;  0.0211  0.0172 0.0169</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Bias in point estimate:</span></span>
<span><span class="co">#&gt;               CC         MI_LOGT             MI_T</span></span>
<span><span class="co">#&gt;  0.0168 (0.0048) 0.0009 (0.0042) -0.0012 (0.0043)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Relative bias in point estimate:</span></span>
<span><span class="co">#&gt;               CC         MI_LOGT             MI_T</span></span>
<span><span class="co">#&gt;  0.0335 (0.0096) 0.0018 (0.0083) -0.0024 (0.0085)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Empirical standard error:</span></span>
<span><span class="co">#&gt;               CC         MI_LOGT            MI_T</span></span>
<span><span class="co">#&gt;  0.1511 (0.0034) 0.1320 (0.0030) 0.1344 (0.0030)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; % gain in precision relative to method CC:</span></span>
<span><span class="co">#&gt;               CC          MI_LOGT             MI_T</span></span>
<span><span class="co">#&gt;  0.0000 (0.0000) 31.0463 (3.9375) 26.3682 (3.8424)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Mean squared error:</span></span>
<span><span class="co">#&gt;               CC         MI_LOGT            MI_T</span></span>
<span><span class="co">#&gt;  0.0231 (0.0011) 0.0174 (0.0009) 0.0181 (0.0009)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model-based standard error:</span></span>
<span><span class="co">#&gt;               CC         MI_LOGT            MI_T</span></span>
<span><span class="co">#&gt;  0.1471 (0.0005) 0.1349 (0.0006) 0.1338 (0.0006)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Relative % error in standard error:</span></span>
<span><span class="co">#&gt;                CC         MI_LOGT             MI_T</span></span>
<span><span class="co">#&gt;  -2.6594 (2.2055) 2.2233 (2.3323) -0.4412 (2.2695)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coverage of nominal 95% confidence interval:</span></span>
<span><span class="co">#&gt;               CC         MI_LOGT            MI_T</span></span>
<span><span class="co">#&gt;  0.9430 (0.0073) 0.9490 (0.0070) 0.9430 (0.0073)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Bias-eliminated coverage of nominal 95% confidence interval:</span></span>
<span><span class="co">#&gt;               CC         MI_LOGT            MI_T</span></span>
<span><span class="co">#&gt;  0.9400 (0.0075) 0.9490 (0.0070) 0.9430 (0.0073)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Power of 5% level test:</span></span>
<span><span class="co">#&gt;               CC         MI_LOGT            MI_T</span></span>
<span><span class="co">#&gt;  0.9460 (0.0071) 0.9690 (0.0055) 0.9630 (0.0060)</span></span></code></pre></div>
<p>The output begins with a brief overview of the setting of the
simulation study (e.g. the method variable, unique methods, etc.), and
continues with each summary statistic by method (if defined, as in this
case). The values that are reported are point estimates with Monte Carlo
standard errors in brackets; however, it is also possible to require
confidence intervals based on Monte Carlo standard errors to be reported
instead:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">ss1</span>, mcse <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Values are:</span></span>
<span><span class="co">#&gt;  Point Estimate (95% Confidence Interval based on Monte Carlo Standard Errors)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Non-missing point estimates/standard errors:</span></span>
<span><span class="co">#&gt;    CC MI_LOGT MI_T</span></span>
<span><span class="co">#&gt;  1000    1000 1000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Average point estimate:</span></span>
<span><span class="co">#&gt;      CC MI_LOGT   MI_T</span></span>
<span><span class="co">#&gt;  0.5168  0.5009 0.4988</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Median point estimate:</span></span>
<span><span class="co">#&gt;      CC MI_LOGT   MI_T</span></span>
<span><span class="co">#&gt;  0.5070  0.4969 0.4939</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Average variance:</span></span>
<span><span class="co">#&gt;      CC MI_LOGT   MI_T</span></span>
<span><span class="co">#&gt;  0.0216  0.0182 0.0179</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Median variance:</span></span>
<span><span class="co">#&gt;      CC MI_LOGT   MI_T</span></span>
<span><span class="co">#&gt;  0.0211  0.0172 0.0169</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Bias in point estimate:</span></span>
<span><span class="co">#&gt;                       CC                  MI_LOGT                      MI_T</span></span>
<span><span class="co">#&gt;  0.0168 (0.0074, 0.0261) 0.0009 (-0.0073, 0.0091) -0.0012 (-0.0095, 0.0071)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Relative bias in point estimate:</span></span>
<span><span class="co">#&gt;                       CC                  MI_LOGT                      MI_T</span></span>
<span><span class="co">#&gt;  0.0335 (0.0148, 0.0523) 0.0018 (-0.0145, 0.0182) -0.0024 (-0.0190, 0.0143)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Empirical standard error:</span></span>
<span><span class="co">#&gt;                       CC                 MI_LOGT                    MI_T</span></span>
<span><span class="co">#&gt;  0.1511 (0.1445, 0.1577) 0.1320 (0.1262, 0.1378) 0.1344 (0.1285, 0.1403)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; % gain in precision relative to method CC:</span></span>
<span><span class="co">#&gt;                       CC                    MI_LOGT                       MI_T</span></span>
<span><span class="co">#&gt;  0.0000 (0.0000, 0.0000) 31.0463 (23.3290, 38.7636) 26.3682 (18.8372, 33.8991)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Mean squared error:</span></span>
<span><span class="co">#&gt;                       CC                 MI_LOGT                    MI_T</span></span>
<span><span class="co">#&gt;  0.0231 (0.0209, 0.0253) 0.0174 (0.0157, 0.0191) 0.0181 (0.0163, 0.0198)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model-based standard error:</span></span>
<span><span class="co">#&gt;                       CC                 MI_LOGT                    MI_T</span></span>
<span><span class="co">#&gt;  0.1471 (0.1461, 0.1481) 0.1349 (0.1338, 0.1361) 0.1338 (0.1327, 0.1350)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Relative % error in standard error:</span></span>
<span><span class="co">#&gt;                         CC                  MI_LOGT                      MI_T</span></span>
<span><span class="co">#&gt;  -2.6594 (-6.9820, 1.6633) 2.2233 (-2.3480, 6.7946) -0.4412 (-4.8894, 4.0070)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coverage of nominal 95% confidence interval:</span></span>
<span><span class="co">#&gt;                       CC                 MI_LOGT                    MI_T</span></span>
<span><span class="co">#&gt;  0.9430 (0.9286, 0.9574) 0.9490 (0.9354, 0.9626) 0.9430 (0.9286, 0.9574)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Bias-eliminated coverage of nominal 95% confidence interval:</span></span>
<span><span class="co">#&gt;                       CC                 MI_LOGT                    MI_T</span></span>
<span><span class="co">#&gt;  0.9400 (0.9253, 0.9547) 0.9490 (0.9354, 0.9626) 0.9430 (0.9286, 0.9574)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Power of 5% level test:</span></span>
<span><span class="co">#&gt;                       CC                 MI_LOGT                    MI_T</span></span>
<span><span class="co">#&gt;  0.9460 (0.9320, 0.9600) 0.9690 (0.9583, 0.9797) 0.9630 (0.9513, 0.9747)</span></span></code></pre></div>
<p>Highlighting some points of interest from the summary results
above:</p>
<ol style="list-style-type: decimal">
<li>The <code>CC</code> method has small-sample bias away from the null
(point estimate 0.0168, with 95% confidence interval: 0.0074 -
0.0261);</li>
<li>
<code>CC</code> is inefficient compared with <code>MI_LOGT</code>
and <code>MI_T</code>: the relative gain in precision for these two
methods is 1.3105% and 1.2637% compared to <code>CC</code>,
respectively;</li>
<li>Model-based standard errors are close to empirical standard
errors;</li>
<li>Coverage of nominal 95% confidence intervals also seems fine, which
is not surprising in view of the generally low (or lack of) bias and
good model-based standard errors;</li>
<li>
<code>CC</code> has lower power compared with <code>MI_LOGT</code>
and <code>MI_T</code>, which is not surprising in view of its
inefficiency.</li>
</ol>
<div class="section level3">
<h3 id="tabulating-summary-statistics">Tabulating summary statistics<a class="anchor" aria-label="anchor" href="#tabulating-summary-statistics"></a>
</h3>
<p>It is straightforward to produce a table of summary statistics for
use in an R Markdown document:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/" class="external-link">knitr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'knitr'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:rsimsum':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     kable</span></span>
<span><span class="fu"><a href="../reference/kable.simsum.html">kable</a></span><span class="op">(</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">ss1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">stat</th>
<th align="right">est</th>
<th align="right">mcse</th>
<th align="left">method</th>
<th align="right">lower</th>
<th align="right">upper</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">nsim</td>
<td align="right">1000.0000000</td>
<td align="right">NA</td>
<td align="left">CC</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">thetamean</td>
<td align="right">0.5167662</td>
<td align="right">NA</td>
<td align="left">CC</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">thetamedian</td>
<td align="right">0.5069935</td>
<td align="right">NA</td>
<td align="left">CC</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">se2mean</td>
<td align="right">0.0216373</td>
<td align="right">NA</td>
<td align="left">CC</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">se2median</td>
<td align="right">0.0211425</td>
<td align="right">NA</td>
<td align="left">CC</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">bias</td>
<td align="right">0.0167662</td>
<td align="right">0.0047787</td>
<td align="left">CC</td>
<td align="right">0.0074001</td>
<td align="right">0.0261322</td>
</tr>
<tr class="odd">
<td align="left">rbias</td>
<td align="right">0.0335323</td>
<td align="right">0.0095574</td>
<td align="left">CC</td>
<td align="right">0.0148003</td>
<td align="right">0.0522644</td>
</tr>
<tr class="even">
<td align="left">empse</td>
<td align="right">0.1511150</td>
<td align="right">0.0033807</td>
<td align="left">CC</td>
<td align="right">0.1444889</td>
<td align="right">0.1577411</td>
</tr>
<tr class="odd">
<td align="left">mse</td>
<td align="right">0.0230940</td>
<td align="right">0.0011338</td>
<td align="left">CC</td>
<td align="right">0.0208717</td>
<td align="right">0.0253163</td>
</tr>
<tr class="even">
<td align="left">relprec</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="left">CC</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
</tr>
<tr class="odd">
<td align="left">modelse</td>
<td align="right">0.1470963</td>
<td align="right">0.0005274</td>
<td align="left">CC</td>
<td align="right">0.1460626</td>
<td align="right">0.1481300</td>
</tr>
<tr class="even">
<td align="left">relerror</td>
<td align="right">-2.6593842</td>
<td align="right">2.2054817</td>
<td align="left">CC</td>
<td align="right">-6.9820490</td>
<td align="right">1.6632806</td>
</tr>
<tr class="odd">
<td align="left">cover</td>
<td align="right">0.9430000</td>
<td align="right">0.0073315</td>
<td align="left">CC</td>
<td align="right">0.9286305</td>
<td align="right">0.9573695</td>
</tr>
<tr class="even">
<td align="left">becover</td>
<td align="right">0.9400000</td>
<td align="right">0.0075100</td>
<td align="left">CC</td>
<td align="right">0.9252807</td>
<td align="right">0.9547193</td>
</tr>
<tr class="odd">
<td align="left">power</td>
<td align="right">0.9460000</td>
<td align="right">0.0071473</td>
<td align="left">CC</td>
<td align="right">0.9319915</td>
<td align="right">0.9600085</td>
</tr>
<tr class="even">
<td align="left">nsim</td>
<td align="right">1000.0000000</td>
<td align="right">NA</td>
<td align="left">MI_LOGT</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">thetamean</td>
<td align="right">0.5009231</td>
<td align="right">NA</td>
<td align="left">MI_LOGT</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">thetamedian</td>
<td align="right">0.4969223</td>
<td align="right">NA</td>
<td align="left">MI_LOGT</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">se2mean</td>
<td align="right">0.0182091</td>
<td align="right">NA</td>
<td align="left">MI_LOGT</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">se2median</td>
<td align="right">0.0172157</td>
<td align="right">NA</td>
<td align="left">MI_LOGT</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">bias</td>
<td align="right">0.0009231</td>
<td align="right">0.0041744</td>
<td align="left">MI_LOGT</td>
<td align="right">-0.0072586</td>
<td align="right">0.0091048</td>
</tr>
<tr class="even">
<td align="left">rbias</td>
<td align="right">0.0018462</td>
<td align="right">0.0083488</td>
<td align="left">MI_LOGT</td>
<td align="right">-0.0145172</td>
<td align="right">0.0182096</td>
</tr>
<tr class="odd">
<td align="left">empse</td>
<td align="right">0.1320064</td>
<td align="right">0.0029532</td>
<td align="left">MI_LOGT</td>
<td align="right">0.1262182</td>
<td align="right">0.1377947</td>
</tr>
<tr class="even">
<td align="left">mse</td>
<td align="right">0.0174091</td>
<td align="right">0.0008813</td>
<td align="left">MI_LOGT</td>
<td align="right">0.0156818</td>
<td align="right">0.0191364</td>
</tr>
<tr class="odd">
<td align="left">relprec</td>
<td align="right">31.0463410</td>
<td align="right">3.9374726</td>
<td align="left">MI_LOGT</td>
<td align="right">23.3290364</td>
<td align="right">38.7636456</td>
</tr>
<tr class="even">
<td align="left">modelse</td>
<td align="right">0.1349413</td>
<td align="right">0.0006046</td>
<td align="left">MI_LOGT</td>
<td align="right">0.1337563</td>
<td align="right">0.1361263</td>
</tr>
<tr class="odd">
<td align="left">relerror</td>
<td align="right">2.2232593</td>
<td align="right">2.3323382</td>
<td align="left">MI_LOGT</td>
<td align="right">-2.3480396</td>
<td align="right">6.7945582</td>
</tr>
<tr class="even">
<td align="left">cover</td>
<td align="right">0.9490000</td>
<td align="right">0.0069569</td>
<td align="left">MI_LOGT</td>
<td align="right">0.9353647</td>
<td align="right">0.9626353</td>
</tr>
<tr class="odd">
<td align="left">becover</td>
<td align="right">0.9490000</td>
<td align="right">0.0069569</td>
<td align="left">MI_LOGT</td>
<td align="right">0.9353647</td>
<td align="right">0.9626353</td>
</tr>
<tr class="even">
<td align="left">power</td>
<td align="right">0.9690000</td>
<td align="right">0.0054808</td>
<td align="left">MI_LOGT</td>
<td align="right">0.9582579</td>
<td align="right">0.9797421</td>
</tr>
<tr class="odd">
<td align="left">nsim</td>
<td align="right">1000.0000000</td>
<td align="right">NA</td>
<td align="left">MI_T</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">thetamean</td>
<td align="right">0.4988092</td>
<td align="right">NA</td>
<td align="left">MI_T</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">thetamedian</td>
<td align="right">0.4939111</td>
<td align="right">NA</td>
<td align="left">MI_T</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">se2mean</td>
<td align="right">0.0179117</td>
<td align="right">NA</td>
<td align="left">MI_T</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">se2median</td>
<td align="right">0.0169319</td>
<td align="right">NA</td>
<td align="left">MI_T</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">bias</td>
<td align="right">-0.0011908</td>
<td align="right">0.0042510</td>
<td align="left">MI_T</td>
<td align="right">-0.0095226</td>
<td align="right">0.0071409</td>
</tr>
<tr class="odd">
<td align="left">rbias</td>
<td align="right">-0.0023817</td>
<td align="right">0.0085020</td>
<td align="left">MI_T</td>
<td align="right">-0.0190452</td>
<td align="right">0.0142819</td>
</tr>
<tr class="even">
<td align="left">empse</td>
<td align="right">0.1344277</td>
<td align="right">0.0030074</td>
<td align="left">MI_T</td>
<td align="right">0.1285333</td>
<td align="right">0.1403221</td>
</tr>
<tr class="odd">
<td align="left">mse</td>
<td align="right">0.0180542</td>
<td align="right">0.0009112</td>
<td align="left">MI_T</td>
<td align="right">0.0162682</td>
<td align="right">0.0198401</td>
</tr>
<tr class="even">
<td align="left">relprec</td>
<td align="right">26.3681613</td>
<td align="right">3.8423791</td>
<td align="left">MI_T</td>
<td align="right">18.8372366</td>
<td align="right">33.8990859</td>
</tr>
<tr class="odd">
<td align="left">modelse</td>
<td align="right">0.1338346</td>
<td align="right">0.0005856</td>
<td align="left">MI_T</td>
<td align="right">0.1326867</td>
<td align="right">0.1349824</td>
</tr>
<tr class="even">
<td align="left">relerror</td>
<td align="right">-0.4412233</td>
<td align="right">2.2695216</td>
<td align="left">MI_T</td>
<td align="right">-4.8894038</td>
<td align="right">4.0069573</td>
</tr>
<tr class="odd">
<td align="left">cover</td>
<td align="right">0.9430000</td>
<td align="right">0.0073315</td>
<td align="left">MI_T</td>
<td align="right">0.9286305</td>
<td align="right">0.9573695</td>
</tr>
<tr class="even">
<td align="left">becover</td>
<td align="right">0.9430000</td>
<td align="right">0.0073315</td>
<td align="left">MI_T</td>
<td align="right">0.9286305</td>
<td align="right">0.9573695</td>
</tr>
<tr class="odd">
<td align="left">power</td>
<td align="right">0.9630000</td>
<td align="right">0.0059692</td>
<td align="left">MI_T</td>
<td align="right">0.9513006</td>
<td align="right">0.9746994</td>
</tr>
</tbody>
</table>
<p>Using <code><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy()</a></code> in combination with R packages such as <a href="https://cran.r-project.org/package=xtable" class="external-link">xtable</a>, <a href="https://cran.r-project.org/package=kableExtra" class="external-link">kableExtra</a>, <a href="https://cran.r-project.org/package=tables" class="external-link">tables</a> can yield a
variety of tables that should suit most purposes.</p>
<p>More information on producing tables directly from R can be found in
the <a href="https://CRAN.R-project.org/view=ReproducibleResearch" class="external-link">CRAN
Task View on Reproducible Research</a>.</p>
</div>
<div class="section level3">
<h3 id="plotting-summary-statistics">Plotting summary statistics<a class="anchor" aria-label="anchor" href="#plotting-summary-statistics"></a>
</h3>
<p>In this section, we show how to plot and compare summary statistics
using the popular R package <a href="https://CRAN.R-project.org/package=ggplot2" class="external-link">ggplot</a>.</p>
<p>Plotting bias by method with <span class="math inline">\(95\%\)</span> confidence intervals based on Monte
Carlo standard errors:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">ss1</span>, stats <span class="op">=</span> <span class="st">"bias"</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">method</span>, y <span class="op">=</span> <span class="va">est</span>, ymin <span class="op">=</span> <span class="va">lower</span>, ymax <span class="op">=</span> <span class="va">upper</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, color <span class="op">=</span> <span class="st">"red"</span>, lty <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html" class="external-link">geom_errorbar</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Method"</span>, y <span class="op">=</span> <span class="st">"Bias"</span><span class="op">)</span></span></code></pre></div>
<p><img src="A-introduction_files/figure-html/ex1-plot-bias-1.png" width="80%" style="display: block; margin: auto;"></p>
<p>Conversely, say we want to visually compare coverage for the three
methods compared with this simulation study:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">ss1</span>, stats <span class="op">=</span> <span class="st">"cover"</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">method</span>, y <span class="op">=</span> <span class="va">est</span>, ymin <span class="op">=</span> <span class="va">lower</span>, ymax <span class="op">=</span> <span class="va">upper</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0.95</span>, color <span class="op">=</span> <span class="st">"red"</span>, lty <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html" class="external-link">geom_errorbar</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Method"</span>, y <span class="op">=</span> <span class="st">"Coverage"</span><span class="op">)</span></span></code></pre></div>
<p><img src="A-introduction_files/figure-html/ex1-plot-cov-1.png" width="80%" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="dropping-large-estimates-and-standard-errors">Dropping large estimates and standard errors<a class="anchor" aria-label="anchor" href="#dropping-large-estimates-and-standard-errors"></a>
</h3>
<p><code>rsimsum</code> allows to automatically drop estimates and
standard errors that are larger than a predefined value. Specifically,
the argument of <code>simsum</code> that control this behaviour is
<code>dropbig</code>, with tuning parameters <code>dropbig.max</code>
and <code>dropbig.semax</code> that can be passed via the
<code>control</code> argument.</p>
<p>Set <code>dropbig</code> to <code>TRUE</code> and standardised
estimates larger than <code>max</code> in absolute value will be
dropped; standard errors larger than <code>semax</code> times the
average standard error will be dropped too. By default, robust
standardisation is used (based on median and inter-quartile range);
however, it is also possible to request regular standardisation (based
on mean and standard deviation) by setting the control parameter
<code>dropbig.robust = FALSE</code>.</p>
<p>For instance, say we want to drop standardised estimates larger than
<span class="math inline">\(3\)</span> in absolute value and standard
errors larger than <span class="math inline">\(1.5\)</span> times the
average standard error:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">s1.2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simsum.html">simsum</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">MIsim</span>, estvarname <span class="op">=</span> <span class="st">"b"</span>, true <span class="op">=</span> <span class="fl">0.50</span>, se <span class="op">=</span> <span class="st">"se"</span>, methodvar <span class="op">=</span> <span class="st">"method"</span>, ref <span class="op">=</span> <span class="st">"CC"</span>, dropbig <span class="op">=</span> <span class="cn">TRUE</span>, control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>dropbig.max <span class="op">=</span> <span class="fl">4</span>, dropbig.semax <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Some estimates were dropped, as we can see from the number of
non-missing point estimates, standard errors:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">s1.2</span>, stats <span class="op">=</span> <span class="st">"nsim"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Values are:</span></span>
<span><span class="co">#&gt;  Point Estimate (Monte Carlo Standard Error)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Non-missing point estimates/standard errors:</span></span>
<span><span class="co">#&gt;   CC MI_LOGT MI_T</span></span>
<span><span class="co">#&gt;  958     951  944</span></span></code></pre></div>
<p>Everything else works analogously as before; for instance, to
summarise the results:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">s1.2</span><span class="op">)</span></span>
<span><span class="co">#&gt; Values are:</span></span>
<span><span class="co">#&gt;  Point Estimate (Monte Carlo Standard Error)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Non-missing point estimates/standard errors:</span></span>
<span><span class="co">#&gt;   CC MI_LOGT MI_T</span></span>
<span><span class="co">#&gt;  958     951  944</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Average point estimate:</span></span>
<span><span class="co">#&gt;      CC MI_LOGT   MI_T</span></span>
<span><span class="co">#&gt;  0.5142  0.4978 0.4973</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Median point estimate:</span></span>
<span><span class="co">#&gt;      CC MI_LOGT   MI_T</span></span>
<span><span class="co">#&gt;  0.5065  0.4934 0.4939</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Average variance:</span></span>
<span><span class="co">#&gt;      CC MI_LOGT   MI_T</span></span>
<span><span class="co">#&gt;  0.0213  0.0175 0.0173</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Median variance:</span></span>
<span><span class="co">#&gt;      CC MI_LOGT   MI_T</span></span>
<span><span class="co">#&gt;  0.0211  0.0170 0.0167</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Bias in point estimate:</span></span>
<span><span class="co">#&gt;               CC          MI_LOGT             MI_T</span></span>
<span><span class="co">#&gt;  0.0142 (0.0048) -0.0022 (0.0043) -0.0027 (0.0043)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Relative bias in point estimate:</span></span>
<span><span class="co">#&gt;           CC      MI_LOGT         MI_T</span></span>
<span><span class="co">#&gt;  0.0283 (NA) -0.0044 (NA) -0.0055 (NA)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Empirical standard error:</span></span>
<span><span class="co">#&gt;               CC         MI_LOGT            MI_T</span></span>
<span><span class="co">#&gt;  0.1493 (0.0034) 0.1320 (0.0030) 0.1323 (0.0030)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; % gain in precision relative to method CC:</span></span>
<span><span class="co">#&gt;               CC          MI_LOGT             MI_T</span></span>
<span><span class="co">#&gt;  0.0000 (0.0000) 27.9890 (3.9442) 27.4611 (4.0317)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Mean squared error:</span></span>
<span><span class="co">#&gt;               CC         MI_LOGT            MI_T</span></span>
<span><span class="co">#&gt;  0.0225 (0.0011) 0.0174 (0.0009) 0.0175 (0.0009)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model-based standard error:</span></span>
<span><span class="co">#&gt;               CC         MI_LOGT            MI_T</span></span>
<span><span class="co">#&gt;  0.1459 (0.0005) 0.1323 (0.0005) 0.1314 (0.0005)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Relative % error in standard error:</span></span>
<span><span class="co">#&gt;                CC         MI_LOGT             MI_T</span></span>
<span><span class="co">#&gt;  -2.2821 (2.2545) 0.2271 (2.3291) -0.6949 (2.3128)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coverage of nominal 95% confidence interval:</span></span>
<span><span class="co">#&gt;               CC         MI_LOGT            MI_T</span></span>
<span><span class="co">#&gt;  0.9447 (0.0074) 0.9464 (0.0073) 0.9417 (0.0076)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Bias-eliminated coverage of nominal 95% confidence interval:</span></span>
<span><span class="co">#&gt;               CC         MI_LOGT            MI_T</span></span>
<span><span class="co">#&gt;  0.9426 (0.0075) 0.9453 (0.0074) 0.9439 (0.0075)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Power of 5% level test:</span></span>
<span><span class="co">#&gt;               CC         MI_LOGT            MI_T</span></span>
<span><span class="co">#&gt;  0.9457 (0.0073) 0.9685 (0.0057) 0.9661 (0.0059)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="example-2-simulation-study-on-survival-modelling">Example 2: Simulation study on survival modelling<a class="anchor" aria-label="anchor" href="#example-2-simulation-study-on-survival-modelling"></a>
</h2>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"relhaz"</span>, package <span class="op">=</span> <span class="st">"rsimsum"</span><span class="op">)</span></span></code></pre></div>
<p>Let’s have a look at the first 10 rows of the dataset:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">relhaz</span>, n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt;    dataset  n    baseline       theta        se model</span></span>
<span><span class="co">#&gt; 1        1 50 Exponential -0.88006151 0.3330172   Cox</span></span>
<span><span class="co">#&gt; 2        2 50 Exponential -0.81460242 0.3253010   Cox</span></span>
<span><span class="co">#&gt; 3        3 50 Exponential -0.14262887 0.3050516   Cox</span></span>
<span><span class="co">#&gt; 4        4 50 Exponential -0.33251820 0.3144033   Cox</span></span>
<span><span class="co">#&gt; 5        5 50 Exponential -0.48269940 0.3064726   Cox</span></span>
<span><span class="co">#&gt; 6        6 50 Exponential -0.03160756 0.3097203   Cox</span></span>
<span><span class="co">#&gt; 7        7 50 Exponential -0.23578090 0.3121350   Cox</span></span>
<span><span class="co">#&gt; 8        8 50 Exponential -0.05046332 0.3136058   Cox</span></span>
<span><span class="co">#&gt; 9        9 50 Exponential -0.22378715 0.3066037   Cox</span></span>
<span><span class="co">#&gt; 10      10 50 Exponential -0.45326446 0.3330173   Cox</span></span></code></pre></div>
<p>The included variables are:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">relhaz</span><span class="op">)</span></span>
<span><span class="co">#&gt; 'data.frame':    1200 obs. of  6 variables:</span></span>
<span><span class="co">#&gt;  $ dataset : int  1 2 3 4 5 6 7 8 9 10 ...</span></span>
<span><span class="co">#&gt;  $ n       : num  50 50 50 50 50 50 50 50 50 50 ...</span></span>
<span><span class="co">#&gt;  $ baseline: chr  "Exponential" "Exponential" "Exponential" "Exponential" ...</span></span>
<span><span class="co">#&gt;  $ theta   : num  -0.88 -0.815 -0.143 -0.333 -0.483 ...</span></span>
<span><span class="co">#&gt;  $ se      : num  0.333 0.325 0.305 0.314 0.306 ...</span></span>
<span><span class="co">#&gt;  $ model   : chr  "Cox" "Cox" "Cox" "Cox" ...</span></span></code></pre></div>
<ul>
<li><p><code>dataset</code>, simulated dataset number;</p></li>
<li><p><code>n</code>, sample size of the simulate dataset;</p></li>
<li><p><code>baseline</code>, baseline hazard function of the simulated
dataset;</p></li>
<li><p><code>model</code>, method used (Cox model or Royston-Parmar
model with 2 degrees of freedom);</p></li>
<li><p><code>theta</code>, point estimate for the log-hazard
ratio;</p></li>
<li><p><code>se</code>, standard error of the point estimate.</p></li>
</ul>
<p><code>rsimsum</code> can summarise results from simulation studies
with several data-generating mechanisms. For instance, with this example
we show how to compute summary statistics by baseline hazard function
and sample size.</p>
<p>In order to summarise results by data-generating factors, it is
sufficient to define the “by” factors in the call to
<code>simsum</code>:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">s2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simsum.html">simsum</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">relhaz</span>, estvarname <span class="op">=</span> <span class="st">"theta"</span>, true <span class="op">=</span> <span class="op">-</span><span class="fl">0.50</span>, se <span class="op">=</span> <span class="st">"se"</span>, methodvar <span class="op">=</span> <span class="st">"model"</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"baseline"</span>, <span class="st">"n"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; 'ref' method was not specified, Cox set as the reference</span></span>
<span><span class="va">s2</span></span>
<span><span class="co">#&gt; Summary of a simulation study with a single estimand.</span></span>
<span><span class="co">#&gt; True value of the estimand: -0.5 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Method variable: model </span></span>
<span><span class="co">#&gt;  Unique methods: Cox, Exp, RP(2) </span></span>
<span><span class="co">#&gt;  Reference method: Cox </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; By factors: baseline, n </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Monte Carlo standard errors were computed.</span></span></code></pre></div>
<p>The difference between <code>methodvar</code> and <code>by</code> is
as follows: <code>methodvar</code> represents methods (e.g. the two
models, in this example) compared with this simulation study, while
<code>by</code> represents all possible data-generating factors that
varied when simulating data (in this case, sample size and the true
baseline hazard function).</p>
<p>Summarising the results will be printed out for each method and
combination of data-generating factors:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ss2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">s2</span><span class="op">)</span></span>
<span><span class="va">ss2</span></span>
<span><span class="co">#&gt; Values are:</span></span>
<span><span class="co">#&gt;  Point Estimate (Monte Carlo Standard Error)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Non-missing point estimates/standard errors:</span></span>
<span><span class="co">#&gt;     baseline   n Cox Exp RP(2)</span></span>
<span><span class="co">#&gt;  Exponential  50 100 100   100</span></span>
<span><span class="co">#&gt;  Exponential 250 100 100   100</span></span>
<span><span class="co">#&gt;      Weibull  50 100 100   100</span></span>
<span><span class="co">#&gt;      Weibull 250 100 100   100</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Average point estimate:</span></span>
<span><span class="co">#&gt;     baseline   n     Cox     Exp   RP(2)</span></span>
<span><span class="co">#&gt;  Exponential  50 -0.4785 -0.4761 -0.4817</span></span>
<span><span class="co">#&gt;  Exponential 250 -0.5215 -0.5214 -0.5227</span></span>
<span><span class="co">#&gt;      Weibull  50 -0.5282 -0.3491 -0.5348</span></span>
<span><span class="co">#&gt;      Weibull 250 -0.5120 -0.3518 -0.5139</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Median point estimate:</span></span>
<span><span class="co">#&gt;     baseline   n     Cox     Exp   RP(2)</span></span>
<span><span class="co">#&gt;  Exponential  50 -0.4507 -0.4571 -0.4574</span></span>
<span><span class="co">#&gt;  Exponential 250 -0.5184 -0.5165 -0.5209</span></span>
<span><span class="co">#&gt;      Weibull  50 -0.5518 -0.3615 -0.5425</span></span>
<span><span class="co">#&gt;      Weibull 250 -0.5145 -0.3633 -0.5078</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Average variance:</span></span>
<span><span class="co">#&gt;     baseline   n    Cox    Exp  RP(2)</span></span>
<span><span class="co">#&gt;  Exponential  50 0.1014 0.0978 0.1002</span></span>
<span><span class="co">#&gt;  Exponential 250 0.0195 0.0191 0.0194</span></span>
<span><span class="co">#&gt;      Weibull  50 0.0931 0.0834 0.0898</span></span>
<span><span class="co">#&gt;      Weibull 250 0.0174 0.0164 0.0172</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Median variance:</span></span>
<span><span class="co">#&gt;     baseline   n    Cox    Exp  RP(2)</span></span>
<span><span class="co">#&gt;  Exponential  50 0.1000 0.0972 0.0989</span></span>
<span><span class="co">#&gt;  Exponential 250 0.0195 0.0190 0.0194</span></span>
<span><span class="co">#&gt;      Weibull  50 0.0914 0.0825 0.0875</span></span>
<span><span class="co">#&gt;      Weibull 250 0.0174 0.0164 0.0171</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Bias in point estimate:</span></span>
<span><span class="co">#&gt;     baseline   n              Cox              Exp            RP(2)</span></span>
<span><span class="co">#&gt;  Exponential  50  0.0215 (0.0328)  0.0239 (0.0326)  0.0183 (0.0331)</span></span>
<span><span class="co">#&gt;  Exponential 250 -0.0215 (0.0149) -0.0214 (0.0151) -0.0227 (0.0149)</span></span>
<span><span class="co">#&gt;      Weibull  50 -0.0282 (0.0311)  0.1509 (0.0204) -0.0348 (0.0311)</span></span>
<span><span class="co">#&gt;      Weibull 250 -0.0120 (0.0133)  0.1482 (0.0093) -0.0139 (0.0137)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Relative bias in point estimate:</span></span>
<span><span class="co">#&gt;     baseline   n              Cox              Exp            RP(2)</span></span>
<span><span class="co">#&gt;  Exponential  50 -0.0430 (0.0657) -0.0478 (0.0652) -0.0366 (0.0662)</span></span>
<span><span class="co">#&gt;  Exponential 250  0.0430 (0.0298)  0.0427 (0.0301)  0.0455 (0.0298)</span></span>
<span><span class="co">#&gt;      Weibull  50  0.0564 (0.0623) -0.3018 (0.0408)  0.0695 (0.0622)</span></span>
<span><span class="co">#&gt;      Weibull 250  0.0241 (0.0267) -0.2963 (0.0186)  0.0279 (0.0274)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Empirical standard error:</span></span>
<span><span class="co">#&gt;     baseline   n             Cox             Exp           RP(2)</span></span>
<span><span class="co">#&gt;  Exponential  50 0.3285 (0.0233) 0.3258 (0.0232) 0.3312 (0.0235)</span></span>
<span><span class="co">#&gt;  Exponential 250 0.1488 (0.0106) 0.1506 (0.0107) 0.1489 (0.0106)</span></span>
<span><span class="co">#&gt;      Weibull  50 0.3115 (0.0221) 0.2041 (0.0145) 0.3111 (0.0221)</span></span>
<span><span class="co">#&gt;      Weibull 250 0.1333 (0.0095) 0.0929 (0.0066) 0.1368 (0.0097)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; % gain in precision relative to method Cox:</span></span>
<span><span class="co">#&gt;     baseline   n              Cox                Exp            RP(2)</span></span>
<span><span class="co">#&gt;  Exponential  50 -0.0000 (0.0000)    1.6773 (3.2902) -1.6228 (1.7887)</span></span>
<span><span class="co">#&gt;  Exponential 250  0.0000 (0.0000)   -2.3839 (3.0501) -0.1491 (0.9916)</span></span>
<span><span class="co">#&gt;      Weibull  50 -0.0000 (0.0000) 132.7958 (16.4433)  0.2412 (3.7361)</span></span>
<span><span class="co">#&gt;      Weibull 250 -0.0000 (0.0000) 105.8426 (12.4932) -4.9519 (2.0647)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Mean squared error:</span></span>
<span><span class="co">#&gt;     baseline   n             Cox             Exp           RP(2)</span></span>
<span><span class="co">#&gt;  Exponential  50 0.1073 (0.0149) 0.1056 (0.0146) 0.1089 (0.0154)</span></span>
<span><span class="co">#&gt;  Exponential 250 0.0224 (0.0028) 0.0229 (0.0028) 0.0225 (0.0028)</span></span>
<span><span class="co">#&gt;      Weibull  50 0.0968 (0.0117) 0.0640 (0.0083) 0.0970 (0.0117)</span></span>
<span><span class="co">#&gt;      Weibull 250 0.0177 (0.0027) 0.0305 (0.0033) 0.0187 (0.0028)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model-based standard error:</span></span>
<span><span class="co">#&gt;     baseline   n             Cox             Exp           RP(2)</span></span>
<span><span class="co">#&gt;  Exponential  50 0.3185 (0.0013) 0.3127 (0.0010) 0.3165 (0.0012)</span></span>
<span><span class="co">#&gt;  Exponential 250 0.1396 (0.0002) 0.1381 (0.0002) 0.1394 (0.0002)</span></span>
<span><span class="co">#&gt;      Weibull  50 0.3052 (0.0014) 0.2888 (0.0005) 0.2996 (0.0012)</span></span>
<span><span class="co">#&gt;      Weibull 250 0.1320 (0.0002) 0.1281 (0.0001) 0.1313 (0.0002)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Relative % error in standard error:</span></span>
<span><span class="co">#&gt;     baseline   n              Cox               Exp            RP(2)</span></span>
<span><span class="co">#&gt;  Exponential  50 -3.0493 (6.9011)  -4.0156 (6.8286) -4.4305 (6.8013)</span></span>
<span><span class="co">#&gt;  Exponential 250 -6.2002 (6.6679)  -8.3339 (6.5160) -6.4133 (6.6528)</span></span>
<span><span class="co">#&gt;      Weibull  50 -2.0115 (6.9776) 41.4993 (10.0594) -3.6873 (6.8549)</span></span>
<span><span class="co">#&gt;      Weibull 250 -0.9728 (7.0397)  37.7762 (9.7917) -4.0191 (6.8228)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coverage of nominal 95% confidence interval:</span></span>
<span><span class="co">#&gt;     baseline   n             Cox             Exp           RP(2)</span></span>
<span><span class="co">#&gt;  Exponential  50 0.9500 (0.0218) 0.9400 (0.0237) 0.9500 (0.0218)</span></span>
<span><span class="co">#&gt;  Exponential 250 0.9300 (0.0255) 0.9200 (0.0271) 0.9300 (0.0255)</span></span>
<span><span class="co">#&gt;      Weibull  50 0.9700 (0.0171) 0.9900 (0.0099) 0.9500 (0.0218)</span></span>
<span><span class="co">#&gt;      Weibull 250 0.9400 (0.0237) 0.8500 (0.0357) 0.9400 (0.0237)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Bias-eliminated coverage of nominal 95% confidence interval:</span></span>
<span><span class="co">#&gt;     baseline   n             Cox             Exp           RP(2)</span></span>
<span><span class="co">#&gt;  Exponential  50 0.9500 (0.0218) 0.9500 (0.0218) 0.9500 (0.0218)</span></span>
<span><span class="co">#&gt;  Exponential 250 0.9400 (0.0237) 0.9400 (0.0237) 0.9400 (0.0237)</span></span>
<span><span class="co">#&gt;      Weibull  50 0.9500 (0.0218) 1.0000 (0.0000) 0.9500 (0.0218)</span></span>
<span><span class="co">#&gt;      Weibull 250 0.9500 (0.0218) 0.9900 (0.0099) 0.9400 (0.0237)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Power of 5% level test:</span></span>
<span><span class="co">#&gt;     baseline   n             Cox             Exp           RP(2)</span></span>
<span><span class="co">#&gt;  Exponential  50 0.3600 (0.0480) 0.3800 (0.0485) 0.3700 (0.0483)</span></span>
<span><span class="co">#&gt;  Exponential 250 0.9800 (0.0140) 0.9900 (0.0099) 0.9900 (0.0099)</span></span>
<span><span class="co">#&gt;      Weibull  50 0.4300 (0.0495) 0.0900 (0.0286) 0.4700 (0.0499)</span></span>
<span><span class="co">#&gt;      Weibull 250 0.9700 (0.0171) 0.8600 (0.0347) 0.9700 (0.0171)</span></span></code></pre></div>
<div class="section level3">
<h3 id="plotting-summary-statistics-1">Plotting summary statistics<a class="anchor" aria-label="anchor" href="#plotting-summary-statistics-1"></a>
</h3>
<p>Tables could get cumbersome when there are many different
data-generating mechanisms. Plots are generally easier to interpret, and
can be generated as easily as before.</p>
<p>Say we want to compare bias for each method by baseline hazard
function and sample size using faceting:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">ss2</span>, stats <span class="op">=</span> <span class="st">"bias"</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">model</span>, y <span class="op">=</span> <span class="va">est</span>, ymin <span class="op">=</span> <span class="va">lower</span>, ymax <span class="op">=</span> <span class="va">upper</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, color <span class="op">=</span> <span class="st">"red"</span>, lty <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html" class="external-link">geom_errorbar</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">baseline</span> <span class="op">~</span> <span class="va">n</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Method"</span>, y <span class="op">=</span> <span class="st">"Bias"</span><span class="op">)</span></span></code></pre></div>
<p><img src="A-introduction_files/figure-html/ex2-plot-bias-1.png" width="80%" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<ul>
<li>White, I.R. 2010. <em>simsum: Analyses of simulation studies
including Monte Carlo error</em>. The Stata Journal 10(3): 369-385</li>
<li>Morris, T.P., White, I.R. and Crowther, M.J. 2019. <em>Using
simulation studies to evaluate statistical methods</em>. Statistics in
Medicine 38:2074-2102</li>
<li>White, I.R., and P. Royston. 2009. <em>Imputing missing covariate
values for the Cox model</em>. Statistics in Medicine
28(15):1982-1998</li>
<li>Little, R.J.A., and D.B. Rubin. 2002. <em>Statistical analysis with
missing data</em>. 2nd ed. Hoboken, NJ: Wiley</li>
<li>van Buuren, S., H.C. Boshuizen, and D.L. Knook. 1999. <em>Multiple
imputation of missing blood pressure covariates in survival
analysis</em>. Statistics in Medicine 18(6):681-694</li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Alessandro Gasparini, Ian R. White.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
